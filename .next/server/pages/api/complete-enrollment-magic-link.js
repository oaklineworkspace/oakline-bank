"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/complete-enrollment-magic-link";
exports.ids = ["pages/api/complete-enrollment-magic-link"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcomplete-enrollment-magic-link&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcomplete-enrollment-magic-link.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcomplete-enrollment-magic-link&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcomplete-enrollment-magic-link.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_complete_enrollment_magic_link_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/complete-enrollment-magic-link.js */ \"(api)/./pages/api/complete-enrollment-magic-link.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_complete_enrollment_magic_link_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_complete_enrollment_magic_link_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/complete-enrollment-magic-link\",\n        pathname: \"/api/complete-enrollment-magic-link\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_complete_enrollment_magic_link_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNvbXBsZXRlLWVucm9sbG1lbnQtbWFnaWMtbGluayZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGY29tcGxldGUtZW5yb2xsbWVudC1tYWdpYy1saW5rLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzBFO0FBQzFFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx5RUFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMseUVBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2FrbGluZS1iYW5rLz84MTUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvY29tcGxldGUtZW5yb2xsbWVudC1tYWdpYy1saW5rLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY29tcGxldGUtZW5yb2xsbWVudC1tYWdpYy1saW5rXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY29tcGxldGUtZW5yb2xsbWVudC1tYWdpYy1saW5rXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcomplete-enrollment-magic-link&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcomplete-enrollment-magic-link.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/supabaseClient.js":
/*!*******************************!*\
  !*** ./lib/supabaseClient.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n// lib/supabaseClient.js\n\n// Supabase configuration - Use your environment variables\nconst supabaseUrl = \"https://nrjdmgltshosdqccaymr.supabase.co\" || 0 || 0;\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5yamRtZ2x0c2hvc2RxY2NheW1yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwMzYyMjAsImV4cCI6MjA3MTYxMjIyMH0.b9H553W2PCsSNvr8HyyINl4nTSrldHN_QMQ3TVwt6qk\" || 0 || 0;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY || process.env.SUPABASE_SERVICE_KEY || \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5yamRtZ2x0c2hvc2RxY2NheW1yIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NjAzNjIyMCwiZXhwIjoyMDcxNjEyMjIwfQ.cXKwVlQNqtAE13jrgmr2RBuIwtEbxqGsVF9SiRwqV_E\";\n// Validate required environment variables\nif (!supabaseUrl || !supabaseAnonKey) {\n    console.error(\"Missing Supabase configuration\");\n}\n// Public client for front-end (browser)\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n// Server-side client with elevated privileges\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc3VwYWJhc2VDbGllbnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNBLHdCQUF3QjtBQUM2QjtBQUVyRCwwREFBMEQ7QUFDMUQsTUFBTUMsY0FBY0MsMENBQW9DLElBQUlBLENBQXdCLElBQUk7QUFDeEYsTUFBTUksa0JBQWtCSixrTkFBeUMsSUFBSUEsQ0FBNkIsSUFBSTtBQUN0RyxNQUFNTyxxQkFBcUJQLFFBQVFDLEdBQUcsQ0FBQ08seUJBQXlCLElBQUlSLFFBQVFDLEdBQUcsQ0FBQ1Esb0JBQW9CLElBQUk7QUFFeEcsMENBQTBDO0FBQzFDLElBQUksQ0FBQ1YsZUFBZSxDQUFDSyxpQkFBaUI7SUFDcENNLFFBQVFDLEtBQUssQ0FBQztBQUNoQjtBQUVBLHdDQUF3QztBQUNqQyxNQUFNQyxXQUFXZCxtRUFBWUEsQ0FBQ0MsYUFBYUssaUJBQWlCO0FBRW5FLDhDQUE4QztBQUN2QyxNQUFNUyxnQkFBZ0JmLG1FQUFZQSxDQUFDQyxhQUFhUSxvQkFBb0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vYWtsaW5lLWJhbmsvLi9saWIvc3VwYWJhc2VDbGllbnQuanM/NWYwZCJdLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vIGxpYi9zdXBhYmFzZUNsaWVudC5qc1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcblxuLy8gU3VwYWJhc2UgY29uZmlndXJhdGlvbiAtIFVzZSB5b3VyIGVudmlyb25tZW50IHZhcmlhYmxlc1xuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfVVJMIHx8ICdodHRwczovL25yamRtZ2x0c2hvc2RxY2NheW1yLnN1cGFiYXNlLmNvJztcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8IHByb2Nlc3MuZW52LlNVUEFCQVNFX0FOT05fS0VZIHx8ICdleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuZXlKcGMzTWlPaUp6ZFhCaFltRnpaU0lzSW5KbFppSTZJbTV5YW1SdFoyeDBjMmh2YzJSeFkyTmhlVzF5SWl3aWNtOXNaU0k2SW1GdWIyNGlMQ0pwWVhRaU9qRTNOVFl3TXpZeU1qQXNJbVY0Y0NJNk1qQTNNVFl4TWpJeU1IMC5iOUg1NTNXMlBDc1NOdnI4SHl5SU5sNG5UU3JsZEhOX1FNUTNUVnd0NnFrJztcbmNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgfHwgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9LRVkgfHwgJ2V5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUpwYzNNaU9pSnpkWEJoWW1GelpTSXNJbkpsWmlJNkltNXlhbVJ0WjJ4MGMyaHZjMlJ4WTJOaGVXMXlJaXdpY205c1pTSTZJbk5sY25acFkyVmZjbTlzWlNJc0ltbGhkQ0k2TVRjMU5qQXpOakl5TUN3aVpYaHdJam95TURjeE5qRXlNakl3ZlEuY1hLd1ZsUU5xdEFFMTNqcmdtcjJSQnVJd3RFYnhxR3NWRjlTaVJ3cVZfRSc7XG5cbi8vIFZhbGlkYXRlIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlc1xuaWYgKCFzdXBhYmFzZVVybCB8fCAhc3VwYWJhc2VBbm9uS2V5KSB7XG4gIGNvbnNvbGUuZXJyb3IoJ01pc3NpbmcgU3VwYWJhc2UgY29uZmlndXJhdGlvbicpO1xufVxuXG4vLyBQdWJsaWMgY2xpZW50IGZvciBmcm9udC1lbmQgKGJyb3dzZXIpXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XG5cbi8vIFNlcnZlci1zaWRlIGNsaWVudCB3aXRoIGVsZXZhdGVkIHByaXZpbGVnZXNcbmV4cG9ydCBjb25zdCBzdXBhYmFzZUFkbWluID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VLZXkpO1xuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIlNVUEFCQVNFX1VSTCIsInN1cGFiYXNlQW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiU1VQQUJBU0VfQU5PTl9LRVkiLCJzdXBhYmFzZVNlcnZpY2VLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiU1VQQUJBU0VfU0VSVklDRV9LRVkiLCJjb25zb2xlIiwiZXJyb3IiLCJzdXBhYmFzZSIsInN1cGFiYXNlQWRtaW4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/supabaseClient.js\n");

/***/ }),

/***/ "(api)/./pages/api/complete-enrollment-magic-link.js":
/*!*****************************************************!*\
  !*** ./pages/api/complete-enrollment-magic-link.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/supabaseClient */ \"(api)/./lib/supabaseClient.js\");\n\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    const { userId, email, password, ssn, id_number, accountNumber, application_id } = req.body;\n    if (!userId || !application_id || !email || !password || !accountNumber) {\n        return res.status(400).json({\n            error: \"Missing required fields: userId, application_id, email, password, and accountNumber are required\"\n        });\n    }\n    // Require either SSN or ID number based on citizenship\n    if (!ssn && !id_number) {\n        return res.status(400).json({\n            error: \"Either SSN or ID number is required\"\n        });\n    }\n    try {\n        // 1️⃣ Get application data\n        const { data: applicationData, error: applicationError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"applications\").select(\"*\").eq(\"id\", application_id).single();\n        if (applicationError || !applicationData) {\n            return res.status(404).json({\n                error: \"Application not found\"\n            });\n        }\n        // 2️⃣ Verify email matches\n        if (applicationData.email !== email) {\n            return res.status(400).json({\n                error: \"Email verification failed\"\n            });\n        }\n        // 3️⃣ Verify identity - either SSN or ID number based on citizenship\n        if (applicationData.country === \"US\") {\n            // US citizens - verify SSN\n            const cleanSSN = ssn ? ssn.replace(/-/g, \"\") : \"\";\n            const applicationSSN = applicationData.ssn ? applicationData.ssn.replace(/-/g, \"\") : \"\";\n            if (applicationSSN && applicationSSN !== cleanSSN) {\n                return res.status(400).json({\n                    error: \"SSN verification failed. Please check your Social Security Number.\"\n                });\n            }\n        } else {\n            // International citizens - verify ID number\n            if (applicationData.id_number && applicationData.id_number !== id_number) {\n                return res.status(400).json({\n                    error: \"ID number verification failed. Please check your Government ID Number.\"\n                });\n            }\n        }\n        // 4️⃣ Verify account number exists for this application\n        const { data: applicationAccounts, error: accountsError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"accounts\").select(\"account_number, account_type, balance\").eq(\"application_id\", application_id);\n        if (accountsError) {\n            console.error(\"Error fetching application accounts:\", accountsError);\n            return res.status(500).json({\n                error: \"Error verifying account information\"\n            });\n        }\n        if (!applicationAccounts || applicationAccounts.length === 0) {\n            return res.status(404).json({\n                error: \"No accounts found for this application\"\n            });\n        }\n        // Verify the selected account number belongs to this application\n        const selectedAccount = applicationAccounts.find((acc)=>acc.account_number === accountNumber);\n        if (!selectedAccount) {\n            return res.status(400).json({\n                error: \"Invalid account number selected\"\n            });\n        }\n        // 5️⃣ Update the user's password in Supabase Auth\n        const { error: updateError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.auth.admin.updateUserById(userId, {\n            password: password\n        });\n        if (updateError) {\n            console.error(\"Error updating user password:\", updateError);\n            return res.status(500).json({\n                error: \"Failed to set password\"\n            });\n        }\n        // 6️⃣ Create or update profile record\n        const profileData = {\n            id: userId,\n            email: applicationData.email,\n            first_name: applicationData.first_name,\n            last_name: applicationData.last_name,\n            middle_name: applicationData.middle_name,\n            phone: applicationData.phone,\n            date_of_birth: applicationData.date_of_birth,\n            country: applicationData.country,\n            address: applicationData.address,\n            city: applicationData.city,\n            state: applicationData.state,\n            zip_code: applicationData.zip_code,\n            application_id: application_id,\n            created_at: new Date().toISOString()\n        };\n        const { error: profileError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"profiles\").upsert([\n            profileData\n        ], {\n            onConflict: \"id\"\n        });\n        if (profileError) {\n            console.error(\"Error creating profile record:\", profileError);\n        // Don't fail the process for profile creation error, just log it\n        }\n        // 7️⃣ Update enrollment record\n        const { error: enrollmentUpdateError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"enrollments\").update({\n            is_used: true,\n            completed_at: new Date().toISOString(),\n            selected_account_number: accountNumber,\n            user_id: userId\n        }).eq(\"application_id\", application_id).eq(\"email\", email);\n        if (enrollmentUpdateError) {\n            console.error(\"Error updating enrollment record:\", enrollmentUpdateError);\n        // Don't fail the process for this\n        }\n        // 8️⃣ Link accounts to the auth user\n        const { error: accountError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"accounts\").update({\n            user_id: userId\n        }).eq(\"application_id\", application_id);\n        if (accountError) {\n            console.error(\"Account update error:\", accountError);\n            return res.status(500).json({\n                error: \"Failed to activate accounts. Please contact support.\"\n            });\n        }\n        res.status(200).json({\n            message: \"Enrollment completed successfully\",\n            user: {\n                id: applicationData.id,\n                email: applicationData.email,\n                name: `${applicationData.first_name} ${applicationData.last_name}`,\n                selected_account: selectedAccount\n            }\n        });\n    } catch (error) {\n        console.error(\"Complete enrollment error:\", error);\n        res.status(500).json({\n            error: \"Internal server error during enrollment completion\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvY29tcGxldGUtZW5yb2xsbWVudC1tYWdpYy1saW5rLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQ3lEO0FBRTFDLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBcUI7SUFDNUQ7SUFFQSxNQUFNLEVBQUVDLE1BQU0sRUFBRUMsS0FBSyxFQUFFQyxRQUFRLEVBQUVDLEdBQUcsRUFBRUMsU0FBUyxFQUFFQyxhQUFhLEVBQUVDLGNBQWMsRUFBRSxHQUFHWixJQUFJYSxJQUFJO0lBRTNGLElBQUksQ0FBQ1AsVUFBVSxDQUFDTSxrQkFBa0IsQ0FBQ0wsU0FBUyxDQUFDQyxZQUFZLENBQUNHLGVBQWU7UUFDdkUsT0FBT1YsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQW1HO0lBQzFJO0lBRUEsdURBQXVEO0lBQ3ZELElBQUksQ0FBQ0ksT0FBTyxDQUFDQyxXQUFXO1FBQ3RCLE9BQU9ULElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFzQztJQUM3RTtJQUVBLElBQUk7UUFDRiwyQkFBMkI7UUFDM0IsTUFBTSxFQUFFUyxNQUFNQyxlQUFlLEVBQUVWLE9BQU9XLGdCQUFnQixFQUFFLEdBQUcsTUFBTWxCLDhEQUFhQSxDQUMzRW1CLElBQUksQ0FBQyxnQkFDTEMsTUFBTSxDQUFDLEtBQ1BDLEVBQUUsQ0FBQyxNQUFNUCxnQkFDVFEsTUFBTTtRQUVULElBQUlKLG9CQUFvQixDQUFDRCxpQkFBaUI7WUFDeEMsT0FBT2QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUF3QjtRQUMvRDtRQUVBLDJCQUEyQjtRQUMzQixJQUFJVSxnQkFBZ0JSLEtBQUssS0FBS0EsT0FBTztZQUNu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LEVBQUUsT0FBT3hCLE9BQU87UUFDZHNCLFFBQVF0QixLQUFLLENBQUMsOEJBQThCQTtRQUM1Q0osSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXFEO0lBQ3JGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vYWtsaW5lLWJhbmsvLi9wYWdlcy9hcGkvY29tcGxldGUtZW5yb2xsbWVudC1tYWdpYy1saW5rLmpzPzkwMWIiXSwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyBzdXBhYmFzZUFkbWluIH0gZnJvbSAnLi4vLi4vbGliL3N1cGFiYXNlQ2xpZW50JztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICB9XG5cbiAgY29uc3QgeyB1c2VySWQsIGVtYWlsLCBwYXNzd29yZCwgc3NuLCBpZF9udW1iZXIsIGFjY291bnROdW1iZXIsIGFwcGxpY2F0aW9uX2lkIH0gPSByZXEuYm9keTtcblxuICBpZiAoIXVzZXJJZCB8fCAhYXBwbGljYXRpb25faWQgfHwgIWVtYWlsIHx8ICFwYXNzd29yZCB8fCAhYWNjb3VudE51bWJlcikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZHM6IHVzZXJJZCwgYXBwbGljYXRpb25faWQsIGVtYWlsLCBwYXNzd29yZCwgYW5kIGFjY291bnROdW1iZXIgYXJlIHJlcXVpcmVkJyB9KTtcbiAgfVxuXG4gIC8vIFJlcXVpcmUgZWl0aGVyIFNTTiBvciBJRCBudW1iZXIgYmFzZWQgb24gY2l0aXplbnNoaXBcbiAgaWYgKCFzc24gJiYgIWlkX251bWJlcikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnRWl0aGVyIFNTTiBvciBJRCBudW1iZXIgaXMgcmVxdWlyZWQnIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyAx77iP4oOjIEdldCBhcHBsaWNhdGlvbiBkYXRhXG4gICAgY29uc3QgeyBkYXRhOiBhcHBsaWNhdGlvbkRhdGEsIGVycm9yOiBhcHBsaWNhdGlvbkVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgnYXBwbGljYXRpb25zJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdpZCcsIGFwcGxpY2F0aW9uX2lkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGFwcGxpY2F0aW9uRXJyb3IgfHwgIWFwcGxpY2F0aW9uRGF0YSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdBcHBsaWNhdGlvbiBub3QgZm91bmQnIH0pO1xuICAgIH1cblxuICAgIC8vIDLvuI/ig6MgVmVyaWZ5IGVtYWlsIG1hdGNoZXNcbiAgICBpZiAoYXBwbGljYXRpb25EYXRhLmVtYWlsICE9PSBlbWFpbCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdFbWFpbCB2ZXJpZmljYXRpb24gZmFpbGVkJyB9KTtcbiAgICB9XG5cbiAgICAvLyAz77iP4oOjIFZlcmlmeSBpZGVudGl0eSAtIGVpdGhlciBTU04gb3IgSUQgbnVtYmVyIGJhc2VkIG9uIGNpdGl6ZW5zaGlwXG4gICAgaWYgKGFwcGxpY2F0aW9uRGF0YS5jb3VudHJ5ID09PSAnVVMnKSB7XG4gICAgICAvLyBVUyBjaXRpemVucyAtIHZlcmlmeSBTU05cbiAgICAgIGNvbnN0IGNsZWFuU1NOID0gc3NuID8gc3NuLnJlcGxhY2UoLy0vZywgJycpIDogJyc7XG4gICAgICBjb25zdCBhcHBsaWNhdGlvblNTTiA9IGFwcGxpY2F0aW9uRGF0YS5zc24gPyBhcHBsaWNhdGlvbkRhdGEuc3NuLnJlcGxhY2UoLy0vZywgJycpIDogJyc7XG4gICAgICBpZiAoYXBwbGljYXRpb25TU04gJiYgYXBwbGljYXRpb25TU04gIT09IGNsZWFuU1NOKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnU1NOIHZlcmlmaWNhdGlvbiBmYWlsZWQuIFBsZWFzZSBjaGVjayB5b3VyIFNvY2lhbCBTZWN1cml0eSBOdW1iZXIuJyB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSW50ZXJuYXRpb25hbCBjaXRpemVucyAtIHZlcmlmeSBJRCBudW1iZXJcbiAgICAgIGlmIChhcHBsaWNhdGlvbkRhdGEuaWRfbnVtYmVyICYmIGFwcGxpY2F0aW9uRGF0YS5pZF9udW1iZXIgIT09IGlkX251bWJlcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0lEIG51bWJlciB2ZXJpZmljYXRpb24gZmFpbGVkLiBQbGVhc2UgY2hlY2sgeW91ciBHb3Zlcm5tZW50IElEIE51bWJlci4nIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDTvuI/ig6MgVmVyaWZ5IGFjY291bnQgbnVtYmVyIGV4aXN0cyBmb3IgdGhpcyBhcHBsaWNhdGlvblxuICAgIGNvbnN0IHsgZGF0YTogYXBwbGljYXRpb25BY2NvdW50cywgZXJyb3I6IGFjY291bnRzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdhY2NvdW50cycpXG4gICAgICAuc2VsZWN0KCdhY2NvdW50X251bWJlciwgYWNjb3VudF90eXBlLCBiYWxhbmNlJylcbiAgICAgIC5lcSgnYXBwbGljYXRpb25faWQnLCBhcHBsaWNhdGlvbl9pZCk7XG5cbiAgICBpZiAoYWNjb3VudHNFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYXBwbGljYXRpb24gYWNjb3VudHM6JywgYWNjb3VudHNFcnJvcik7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIHZlcmlmeWluZyBhY2NvdW50IGluZm9ybWF0aW9uJyB9KTtcbiAgICB9XG5cbiAgICBpZiAoIWFwcGxpY2F0aW9uQWNjb3VudHMgfHwgYXBwbGljYXRpb25BY2NvdW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnTm8gYWNjb3VudHMgZm91bmQgZm9yIHRoaXMgYXBwbGljYXRpb24nIH0pO1xuICAgIH1cblxuICAgIC8vIFZlcmlmeSB0aGUgc2VsZWN0ZWQgYWNjb3VudCBudW1iZXIgYmVsb25ncyB0byB0aGlzIGFwcGxpY2F0aW9uXG4gICAgY29uc3Qgc2VsZWN0ZWRBY2NvdW50ID0gYXBwbGljYXRpb25BY2NvdW50cy5maW5kKGFjYyA9PiBhY2MuYWNjb3VudF9udW1iZXIgPT09IGFjY291bnROdW1iZXIpO1xuICAgIGlmICghc2VsZWN0ZWRBY2NvdW50KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgYWNjb3VudCBudW1iZXIgc2VsZWN0ZWQnIH0pO1xuICAgIH1cblxuICAgIC8vIDXvuI/ig6MgVXBkYXRlIHRoZSB1c2VyJ3MgcGFzc3dvcmQgaW4gU3VwYWJhc2UgQXV0aFxuICAgIGNvbnN0IHsgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluLmF1dGguYWRtaW4udXBkYXRlVXNlckJ5SWQoXG4gICAgICB1c2VySWQsXG4gICAgICB7IHBhc3N3b3JkOiBwYXNzd29yZCB9XG4gICAgKTtcblxuICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgdXNlciBwYXNzd29yZDonLCB1cGRhdGVFcnJvcik7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBzZXQgcGFzc3dvcmQnIH0pO1xuICAgIH1cblxuICAgIC8vIDbvuI/ig6MgQ3JlYXRlIG9yIHVwZGF0ZSBwcm9maWxlIHJlY29yZFxuICAgIGNvbnN0IHByb2ZpbGVEYXRhID0ge1xuICAgICAgaWQ6IHVzZXJJZCxcbiAgICAgIGVtYWlsOiBhcHBsaWNhdGlvbkRhdGEuZW1haWwsXG4gICAgICBmaXJzdF9uYW1lOiBhcHBsaWNhdGlvbkRhdGEuZmlyc3RfbmFtZSxcbiAgICAgIGxhc3RfbmFtZTogYXBwbGljYXRpb25EYXRhLmxhc3RfbmFtZSxcbiAgICAgIG1pZGRsZV9uYW1lOiBhcHBsaWNhdGlvbkRhdGEubWlkZGxlX25hbWUsXG4gICAgICBwaG9uZTogYXBwbGljYXRpb25EYXRhLnBob25lLFxuICAgICAgZGF0ZV9vZl9iaXJ0aDogYXBwbGljYXRpb25EYXRhLmRhdGVfb2ZfYmlydGgsXG4gICAgICBjb3VudHJ5OiBhcHBsaWNhdGlvbkRhdGEuY291bnRyeSxcbiAgICAgIGFkZHJlc3M6IGFwcGxpY2F0aW9uRGF0YS5hZGRyZXNzLFxuICAgICAgY2l0eTogYXBwbGljYXRpb25EYXRhLmNpdHksXG4gICAgICBzdGF0ZTogYXBwbGljYXRpb25EYXRhLnN0YXRlLFxuICAgICAgemlwX2NvZGU6IGFwcGxpY2F0aW9uRGF0YS56aXBfY29kZSxcbiAgICAgIGFwcGxpY2F0aW9uX2lkOiBhcHBsaWNhdGlvbl9pZCxcbiAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG5cbiAgICBjb25zdCB7IGVycm9yOiBwcm9maWxlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdwcm9maWxlcycpXG4gICAgICAudXBzZXJ0KFtwcm9maWxlRGF0YV0sIHsgb25Db25mbGljdDogJ2lkJyB9KTtcblxuICAgIGlmIChwcm9maWxlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHByb2ZpbGUgcmVjb3JkOicsIHByb2ZpbGVFcnJvcik7XG4gICAgICAvLyBEb24ndCBmYWlsIHRoZSBwcm9jZXNzIGZvciBwcm9maWxlIGNyZWF0aW9uIGVycm9yLCBqdXN0IGxvZyBpdFxuICAgIH1cblxuICAgIC8vIDfvuI/ig6MgVXBkYXRlIGVucm9sbG1lbnQgcmVjb3JkXG4gICAgY29uc3QgeyBlcnJvcjogZW5yb2xsbWVudFVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgnZW5yb2xsbWVudHMnKVxuICAgICAgLnVwZGF0ZSh7IFxuICAgICAgICBpc191c2VkOiB0cnVlLFxuICAgICAgICBjb21wbGV0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgc2VsZWN0ZWRfYWNjb3VudF9udW1iZXI6IGFjY291bnROdW1iZXIsXG4gICAgICAgIHVzZXJfaWQ6IHVzZXJJZFxuICAgICAgfSlcbiAgICAgIC5lcSgnYXBwbGljYXRpb25faWQnLCBhcHBsaWNhdGlvbl9pZClcbiAgICAgIC5lcSgnZW1haWwnLCBlbWFpbCk7XG5cbiAgICBpZiAoZW5yb2xsbWVudFVwZGF0ZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBlbnJvbGxtZW50IHJlY29yZDonLCBlbnJvbGxtZW50VXBkYXRlRXJyb3IpO1xuICAgICAgLy8gRG9uJ3QgZmFpbCB0aGUgcHJvY2VzcyBmb3IgdGhpc1xuICAgIH1cblxuICAgIC8vIDjvuI/ig6MgTGluayBhY2NvdW50cyB0byB0aGUgYXV0aCB1c2VyXG4gICAgY29uc3QgeyBlcnJvcjogYWNjb3VudEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgnYWNjb3VudHMnKVxuICAgICAgLnVwZGF0ZSh7IFxuICAgICAgICB1c2VyX2lkOiB1c2VySWRcbiAgICAgIH0pXG4gICAgICAuZXEoJ2FwcGxpY2F0aW9uX2lkJywgYXBwbGljYXRpb25faWQpO1xuXG4gICAgaWYgKGFjY291bnRFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQWNjb3VudCB1cGRhdGUgZXJyb3I6JywgYWNjb3VudEVycm9yKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIGFjdGl2YXRlIGFjY291bnRzLiBQbGVhc2UgY29udGFjdCBzdXBwb3J0LicgfSk7XG4gICAgfVxuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgbWVzc2FnZTogJ0Vucm9sbG1lbnQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBhcHBsaWNhdGlvbkRhdGEuaWQsXG4gICAgICAgIGVtYWlsOiBhcHBsaWNhdGlvbkRhdGEuZW1haWwsXG4gICAgICAgIG5hbWU6IGAke2FwcGxpY2F0aW9uRGF0YS5maXJzdF9uYW1lfSAke2FwcGxpY2F0aW9uRGF0YS5sYXN0X25hbWV9YCxcbiAgICAgICAgc2VsZWN0ZWRfYWNjb3VudDogc2VsZWN0ZWRBY2NvdW50XG4gICAgICB9XG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdDb21wbGV0ZSBlbnJvbGxtZW50IGVycm9yOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yIGR1cmluZyBlbnJvbGxtZW50IGNvbXBsZXRpb24nIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsic3VwYWJhc2VBZG1pbiIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJ1c2VySWQiLCJlbWFpbCIsInBhc3N3b3JkIiwic3NuIiwiaWRfbnVtYmVyIiwiYWNjb3VudE51bWJlciIsImFwcGxpY2F0aW9uX2lkIiwiYm9keSIsImRhdGEiLCJhcHBsaWNhdGlvbkRhdGEiLCJhcHBsaWNhdGlvbkVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiY291bnRyeSIsImNsZWFuU1NOIiwicmVwbGFjZSIsImFwcGxpY2F0aW9uU1NOIiwiYXBwbGljYXRpb25BY2NvdW50cyIsImFjY291bnRzRXJyb3IiLCJjb25zb2xlIiwibGVuZ3RoIiwic2VsZWN0ZWRBY2NvdW50IiwiZmluZCIsImFjYyIsImFjY291bnRfbnVtYmVyIiwidXBkYXRlRXJyb3IiLCJhdXRoIiwiYWRtaW4iLCJ1cGRhdGVVc2VyQnlJZCIsInByb2ZpbGVEYXRhIiwiaWQiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwibWlkZGxlX25hbWUiLCJwaG9uZSIsImRhdGVfb2ZfYmlydGgiLCJhZGRyZXNzIiwiY2l0eSIsInN0YXRlIiwiemlwX2NvZGUiLCJjcmVhdGVkX2F0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwicHJvZmlsZUVycm9yIiwidXBzZXJ0Iiwib25Db25mbGljdCIsImVucm9sbG1lbnRVcGRhdGVFcnJvciIsInVwZGF0ZSIsImlzX3VzZWQiLCJjb21wbGV0ZWRfYXQiLCJzZWxlY3RlZF9hY2NvdW50X251bWJlciIsInVzZXJfaWQiLCJhY2NvdW50RXJyb3IiLCJtZXNzYWdlIiwidXNlciIsIm5hbWUiLCJzZWxlY3RlZF9hY2NvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/complete-enrollment-magic-link.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcomplete-enrollment-magic-link&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcomplete-enrollment-magic-link.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();